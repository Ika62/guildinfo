{% extends 'index.twig' %}

{% block body %}
   <div align="center">

   <div class="emblem-container">

   {%if guild.side == 1 %}
      <img class="emblem" src="/images/guild/tabards/ring-horde.png">
   {% else %}
      <img class="emblem" src="/images/guild/tabards/ring-alliance.png">
   {%endif %}
   <img class="emblem-front" src="/images/guild/tabards/shadow_00.png">
   <img class="emblem-front" src="/images/guild/tabards/bg_00.png" onload="recolor(this, '{{ guild.emblem.backgroundColor}}')">

   <img class="emblem-front" src="/images/guild/tabards/hooks.png">

   <img class="emblem-front-border" src="/images/guild/tabards/border_0{{guild.emblem.border}}.png">
   <img id="guild-icon" class="emblem-front-logo" src="/images/guild/tabards/emblem_{{guild.emblem.icon}}.png">




   </div>

       <h1> {{ guild.name }}</h1>
       <p>Serveur: {{ guild.realm }} </p>
       <p>Niveau: {{ guild.level }} </p>
       <p>Points de haut-faits: {{ guild.achievementPoints }} </p>


   </div>

    <script>


        var canvas = document.createElement("canvas");
        var ctx = canvas.getContext("2d");
        var originalPixels = null;
        var currentPixels = null;

        function recolor(img, color)
        {
            canvas.width = img.width;
            canvas.height = img.height;
            ctx.drawImage(img, 0, 0, img.naturalWidth, img.naturalHeight, 0, 0, img.width, img.height);
            originalPixels = ctx.getImageData(0, 0, img.width, img.height);
            currentPixels = ctx.getImageData(0, 0, img.width, img.height);

            changeColor(img, color);
        }

        function hexToRGB(hex){
            var r = parseInt(hex.substring(2,4), 16);
            var g = parseInt(hex.substring(4,6), 16);
            var b = parseInt(hex.substring(6,8), 16);

            return {
                R: r,
                G: g,
                B: b,
            };
        }

        function changeColor(img, color)
        {
            if(!originalPixels) return; // Check if image has loaded
            var newColor = hexToRGB(color);

            for(var I = 0, L = originalPixels.data.length; I < L; I += 4)
            {
                if(currentPixels.data[I + 3] > 5) // If it's not a transparent pixel
                {
                    currentPixels.data[I] = originalPixels.data[I] / 255 * newColor.R;
                    currentPixels.data[I + 1] = originalPixels.data[I + 1] / 255 * newColor.G;
                    currentPixels.data[I + 2] = originalPixels.data[I + 2] / 255 * newColor.B;
                }
            }

            ctx.putImageData(currentPixels, 0, 0);
            img.src = canvas.toDataURL("image/png");
        }



    </script>
{% endblock %}

{% block stylesheets %}
<style>
    body { background: #F5F5F5; font: 18px/1.5 sans-serif; }
    h1, h2 { line-height: 1.2; margin: 0 0 .5em; }
    h1 { font-size: 36px; }
    h2 { font-size: 21px; margin-bottom: 1em; }
    p { margin: 0 0 1em 0; }
    a { color: #0000F0; }
    a:hover { text-decoration: none; }
    code { background: #F5F5F5; max-width: 100px; padding: 2px 6px; word-wrap: break-word; }
    #welcome h1 span { display: block; font-size: 75%; }
    @media (min-width: 768px) {
        #status a, #next a { display: block; }
        @-webkit-keyframes fade-in { 0% { opacity: 0; } 100% { opacity: 1; } }
        @keyframes fade-in { 0% { opacity: 0; } 100% { opacity: 1; } }
    }
    img {
      user-drag: none;
      user-select: none;
      -moz-user-select: none;
      -webkit-user-drag: none;
      -webkit-user-select: none;
      -ms-user-select: none;
    }
    .emblem-container {
      margin:0;
      padding:0;
      height:216px;
      width:216px;
      max-height:216px;
      max-width:216px;
      position:relative;
      overflow:visible;
    }
    .emblem {
      position: absolute;
      top:0;
      left:0;
    }
    .emblem-front {
      position: absolute;
      top:15px;
      left:15px;
    }
    .emblem-front-border {
      position: absolute;
      top:28px;
      left:28px;
    }
    .emblem-front-logo {
      position: absolute;
      top:45px;
      left:30px;
    }
</style>
{% endblock %}
